# POE2 过滤器一键安装脚本使用说明

## 📁 文件说明

- **安装过滤器.bat** - Windows批处理文件，双击运行
- **安装过滤器.ps1** - PowerShell安装脚本
- **安装说明.md** - 本说明文档

## ✨ 功能特点

1. **一键安装** - 双击即可完成所有过滤器文件和声音文件的软链接创建
2. **智能检测** - 自动检测POE2游戏目录
3. **安全提示** - 文件已存在时提示确认
4. **快捷操作** - 回车确认，ESC取消
5. **自动同步** - 修改本目录文件后游戏中直接生效

## 🚀 使用步骤

### 方法1：双击运行（推荐）

1. 双击 `安装过滤器.bat`
2. 查看检测信息
3. 如果有文件已存在：
   - 按 **回车键** 确认替换
   - 按 **ESC** 取消操作
4. 等待安装完成
5. 启动POE2，在游戏设置中选择过滤器

### 方法2：右键以管理员身份运行

如果遇到权限问题：

1. 右键点击 `安装过滤器.bat`
2. 选择 **"以管理员身份运行"**
3. 后续步骤同上

## ⚙️ 系统要求

### Windows 11

创建符号链接需要以下条件之一：

1. **管理员权限**
2. **开发者模式已启用**

#### 启用开发者模式

1. 打开 **设置**
2. 进入 **更新和安全** > **开发者选项**
3. 打开 **开发人员模式**

## 📂 目录结构

安装后会创建以下符号链接：

```
%USERPROFILE%\Documents\My Games\Path of Exile 2\
├── poe2-0.4.filter          → 当前目录\poe2-0.4.filter
├── sounds\                  → 当前目录\sounds\
│   ├── currency\
│   ├── unique\
│   ├── crafting\
│   ├── fragment\
│   └── other\
```

## 🔄 更新过滤器

由于使用的是符号链接，更新非常简单：

1. 在当前目录修改 `.filter` 文件
2. 保存即可，游戏中自动生效
3. 无需重新运行安装脚本

## ❓ 常见问题

### Q1: 提示"找不到POE2游戏目录"

**解决方案：**
- 确认已安装 Path of Exile 2
- 确认游戏至少运行过一次
- 确认使用的是默认安装路径：
  `C:\Users\你的用户名\Documents\My Games\Path of Exile 2\`

### Q2: 提示权限不足

**解决方案：**
- 以管理员身份运行 `安装过滤器.bat`
- 或启用 Windows 开发者模式

### Q3: 创建符号链接失败

**解决方案：**
1. 检查是否满足权限要求
2. 确认目标目录没有被其他程序占用
3. 尝试关闭POE2游戏后重新运行

### Q4: 如何卸载

**解决方案：**
1. 进入 POE2 过滤器目录：
   `%USERPROFILE%\Documents\My Games\Path of Exile 2\`
2. 删除对应的 `.filter` 文件和 `sounds` 目录即可
3. 不会影响本目录的源文件

## 💡 提示

- ✅ 符号链接不会复制文件，只是创建引用，节省空间
- ✅ 修改本目录的过滤器后，游戏中直接生效
- ✅ 删除目标目录的链接不会影响源文件
- ✅ 删除源文件会导致链接失效
- ⚠️ 不要移动或重命名本目录的文件，否则链接会失效

## 📝 技术细节

### 符号链接 vs 硬链接 vs 快捷方式

| 特性 | 符号链接 | 硬链接 | 快捷方式 |
|------|---------|--------|---------|
| POE2识别 | ✅ | ✅ | ❌ |
| 跨分区支持 | ✅ | ❌ | ✅ |
| 目录支持 | ✅ | ❌ | ✅ |
| 删除源文件影响 | ❌ 链接失效 | ❌ 链接失效 | ✅ 快捷方式失效 |

本脚本使用**符号链接**，因为：
1. POE2能够识别符号链接
2. 支持目录链接
3. 相对安全，删除源文件时链接会失效但不会造成数据丢失

## 🆘 获取帮助

如果遇到问题：

1. 查看本说明文档
2. 检查系统要求是否满足
3. 查看脚本运行时的错误信息
4. 尝试以管理员身份运行

---

**版本：** 1.0
**更新日期：** 2025-01-01
**适用系统：** Windows 11
**适用游戏：** Path of Exile 2 (0.4赛季)
